<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Psicología UNAB</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      background: #fff0f5;
    }
    h1 {
      text-align: center;
      color: #b30059;
    }
    .leyenda {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .leyenda-item {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9em;
      padding: 5px 10px;
      border-radius: 5px;
    }
    .malla {
      display: flex;
      overflow-x: auto;
      gap: 20px;
      padding-bottom: 40px;
    }
    .semestre {
      display: flex;
      flex-direction: column;
      background: #ffeaf3;
      border-radius: 10px;
      padding: 10px;
      min-width: 180px;
      border: 1px solid #e2b5c6;
    }
    .semestre h3 {
      text-align: center;
      color: #b30059;
      margin: 5px 0;
    }
    .ramo {
      padding: 8px;
      border-radius: 8px;
      margin: 5px 0;
      cursor: pointer;
      text-align: center;
      transition: 0.3s;
      opacity: 0.5;
      font-size: 0.9em;
    }
    .ramo.activo {
      opacity: 1;
    }
    .ramo.aprobado {
      text-decoration: line-through;
      background-color: #d63384 !important;
      color: white;
    }
    .separator, .anio {
      writing-mode: vertical-lr;
      transform: rotate(180deg);
      text-align: center;
      font-weight: bold;
      color: #880e4f;
      background: #ffe6f0;
      padding: 10px;
      border-left: 4px solid #880e4f;
      font-size: 1.1em;
    }
    .ambito1 { background: #fce4ec; }
    .ambito2 { background: #f8bbd0; }
    .ambito3 { background: #f48fb1; }
    .ambito4 { background: #f06292; }
    .ambito5 { background: #ec407a; }
    .integradora { background: #f3c2d3; }
  </style>
</head>
<body>

<h1>Malla Psicología – UNAB</h1>

<div class="leyenda">
  <div class="leyenda-item ambito1">Ámbito I: Interdisciplina e Inglés</div>
  <div class="leyenda-item ambito2">Ámbito II: Conceptuales Transversales</div>
  <div class="leyenda-item ambito3">Ámbito III: Diagnóstico</div>
  <div class="leyenda-item ambito4">Ámbito IV: Intervención</div>
  <div class="leyenda-item ambito5">Ámbito V: Investigación</div>
  <div class="leyenda-item integradora">Experiencias Integradoras</div>
</div>

<div class="malla" id="malla"></div>

<script>
const ramos = [/* mismo array completo */];

const contenedor = document.getElementById('malla');
const totalSemestres = 10;

for (let i = 1; i <= totalSemestres; i++) {
  // Insertar título de año
  if (i === 1) addTituloAño("PRIMER AÑO");
  if (i === 3) addTituloAño("SEGUNDO AÑO");
  if (i === 5) addTituloAño("TERCER AÑO");
  if (i === 7) addTituloAño("CUARTO AÑO");
  if (i === 9) {
    addTituloAño("QUINTO AÑO");
    const sep = document.createElement('div');
    sep.className = 'separator';
    sep.innerText = 'LICENCIADO/A EN PSICOLOGÍA';
    contenedor.appendChild(sep);
  }

  const sem = document.createElement('div');
  sem.className = 'semestre';
  sem.id = 'sem' + i;
  const h = document.createElement('h3');
  h.textContent = `Semestre ${i}`;
  sem.appendChild(h);
  contenedor.appendChild(sem);
}

function addTituloAño(texto) {
  const div = document.createElement('div');
  div.className = 'anio';
  div.innerText = texto;
  contenedor.appendChild(div);
}

ramos.forEach(ramo => {
  if (ramo.separator) return;
  const div = document.createElement('div');
  div.className = `ramo ${ramo.ambito}`;
  div.dataset.id = ramo.id;
  div.dataset.prereq = JSON.stringify(ramo.prereq);
  div.textContent = ramo.nombre;
  if (ramo.prereq.length === 0) div.classList.add('activo');
  div.onclick = () => toggleAprobado(div);
  document.getElementById('sem' + ramo.semestre).appendChild(div);
});

function toggleAprobado(el) {
  if (!el.classList.contains('activo')) return;
  el.classList.toggle('aprobado');
  const aprobados = Array.from(document.querySelectorAll('.ramo.aprobado')).map(r => r.dataset.id);
  document.querySelectorAll('.ramo').forEach(ramo => {
    const prereqs = JSON.parse(ramo.dataset.prereq);
    const cumple = prereqs.every(p => aprobados.includes(p));
    if (cumple) ramo.classList.add('activo');
    else ramo.classList.remove('activo');
  });
}
</script>

</body>
</html>
